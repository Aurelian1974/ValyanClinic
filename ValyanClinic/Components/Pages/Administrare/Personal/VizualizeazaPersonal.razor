@using ValyanClinic.Domain.Models
@using ValyanClinic.Domain.Enums
@using ValyanClinic.Application.Services
@using Syncfusion.Blazor.Buttons
@using Syncfusion.Blazor.Notifications
@rendermode InteractiveServer
@using PersonalModel = ValyanClinic.Domain.Models.Personal

<link href="~/css/pages/view-personal-syncfusion.css" rel="stylesheet" />

<div class="view-personal-modal-content">
    @if (HasError)
    {
        <div class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            @ErrorMessage
        </div>
    }

    @if (IsLoading)
    {
        <div class="loading-container">
            <div class="loading-indicator">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Se încarcă...</span>
            </div>
        </div>
    }
    else if (PersonalData != null)
    {
        <div class="personal-details-dashboard">
            @* Personal Information Section *@
            <div class="detail-card">
                <div class="card-header">
                    <i class="fas fa-id-card"></i>
                    <h3>Informații Personale</h3>
                </div>
                <div class="card-content">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>Nume</label>
                            <span class="field-value">@PersonalData.Nume</span>
                        </div>
                        <div class="form-field">
                            <label>Prenume</label>
                            <span class="field-value">@PersonalData.Prenume</span>
                        </div>
                        <div class="form-field">
                            <label>CNP</label>
                            <span class="field-value">@PersonalData.CNP</span>
                        </div>
                        <div class="form-field">
                            <label>Data Nașterii</label>
                            <span class="field-value">@PersonalData.Data_Nasterii.ToString("dd.MM.yyyy") (@PersonalData.Varsta ani)</span>
                        </div>
                        <div class="form-field">
                            <label>Locul Nașterii</label>
                            <span class="field-value">@(PersonalData.Locul_Nasterii ?? "Nu este specificat")</span>
                        </div>
                        <div class="form-field">
                            <label>Stare Civilă</label>
                            <span class="field-value">@GetStareCivilaDisplay(PersonalData.Stare_Civila)</span>
                        </div>
                        <div class="form-field">
                            <label>Naționalitate</label>
                            <span class="field-value">@PersonalData.Nationalitate</span>
                        </div>
                        <div class="form-field">
                            <label>Cetățenie</label>
                            <span class="field-value">@PersonalData.Cetatenie</span>
                        </div>
                    </div>
                </div>
            </div>

            @* Professional Information Section *@
            <div class="detail-card">
                <div class="card-header">
                    <i class="fas fa-briefcase"></i>
                    <h3>Informații Profesionale</h3>
                </div>
                <div class="card-content">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>Cod Angajat</label>
                            <span class="field-value">@PersonalData.Cod_Angajat</span>
                        </div>
                        <div class="form-field">
                            <label>Funcția</label>
                            <span class="field-value">@PersonalData.Functia</span>
                        </div>
                        <div class="form-field">
                            <label>Departament</label>
                            <span class="field-value">@GetDepartamentDisplay(PersonalData.Departament)</span>
                        </div>
                        <div class="form-field">
                            <label>Status</label>
                            <SfBadge CssClass="@($"status-badge status-{PersonalData.Status_Angajat.ToString().ToLower()}")">
                                @GetStatusDisplay(PersonalData.Status_Angajat)
                            </SfBadge>
                        </div>
                    </div>
                </div>
            </div>

            @* Contact Information Section *@
            <div class="detail-card">
                <div class="card-header">
                    <i class="fas fa-address-book"></i>
                    <h3>Informații Contact</h3>
                </div>
                <div class="card-content">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>Telefon Personal</label>
                            @if (!string.IsNullOrEmpty(PersonalData.Telefon_Personal))
                            {
                                <a href="tel:@PersonalData.Telefon_Personal" class="field-value contact-link">
                                    <i class="fas fa-phone"></i> @PersonalData.Telefon_Personal
                                </a>
                            }
                            else
                            {
                                <span class="field-value">Nu este specificat</span>
                            }
                        </div>
                        <div class="form-field">
                            <label>Telefon Serviciu</label>
                            @if (!string.IsNullOrEmpty(PersonalData.Telefon_Serviciu))
                            {
                                <a href="tel:@PersonalData.Telefon_Serviciu" class="field-value contact-link">
                                    <i class="fas fa-phone-alt"></i> @PersonalData.Telefon_Serviciu
                                </a>
                            }
                            else
                            {
                                <span class="field-value">Nu este specificat</span>
                            }
                        </div>
                        <div class="form-field full-width">
                            <label>Email Personal</label>
                            @if (!string.IsNullOrEmpty(PersonalData.Email_Personal))
                            {
                                <a href="mailto:@PersonalData.Email_Personal" class="field-value contact-link">
                                    <i class="fas fa-envelope"></i> @PersonalData.Email_Personal
                                </a>
                            }
                            else
                            {
                                <span class="field-value">Nu este specificat</span>
                            }
                        </div>
                        <div class="form-field full-width">
                            <label>Email Serviciu</label>
                            @if (!string.IsNullOrEmpty(PersonalData.Email_Serviciu))
                            {
                                <a href="mailto:@PersonalData.Email_Serviciu" class="field-value contact-link">
                                    <i class="fas fa-envelope-open"></i> @PersonalData.Email_Serviciu
                                </a>
                            }
                            else
                            {
                                <span class="field-value">Nu este specificat</span>
                            }
                        </div>
                    </div>
                </div>
            </div>

            @* Address Information Section *@
            <div class="detail-card">
                <div class="card-header">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3>Informații Adresă</h3>
                </div>
                <div class="card-content">
                    <div class="form-grid">
                        <div class="form-field full-width">
                            <label>Adresa Domiciliu</label>
                            <span class="field-value">@PersonalData.Adresa_Domiciliu</span>
                        </div>
                        <div class="form-field">
                            <label>Județul</label>
                            <span class="field-value">@PersonalData.Judet_Domiciliu</span>
                        </div>
                        <div class="form-field">
                            <label>Orașul</label>
                            <span class="field-value">@PersonalData.Oras_Domiciliu</span>
                        </div>
                        @if (!string.IsNullOrEmpty(PersonalData.Cod_Postal_Domiciliu))
                        {
                            <div class="form-field">
                                <label>Cod Poștal</label>
                                <span class="field-value">@PersonalData.Cod_Postal_Domiciliu</span>
                            </div>
                        }
                    </div>

                    @if (!string.IsNullOrEmpty(PersonalData.Adresa_Resedinta))
                    {
                        <div class="address-separator">
                            <span>Adresa Reședință (dacă diferă)</span>
                        </div>
                        <div class="form-grid">
                            <div class="form-field full-width">
                                <label>Adresa Reședință</label>
                                <span class="field-value">@PersonalData.Adresa_Resedinta</span>
                            </div>
                            <div class="form-field">
                                <label>Județul</label>
                                <span class="field-value">@(PersonalData.Judet_Resedinta ?? "Nu este specificat")</span>
                            </div>
                            <div class="form-field">
                                <label>Orașul</label>
                                <span class="field-value">@(PersonalData.Oras_Resedinta ?? "Nu este specificat")</span>
                            </div>
                        </div>
                    }
                </div>
            </div>

            @* Document Information Section *@
            @if (!string.IsNullOrEmpty(PersonalData.Serie_CI) || !string.IsNullOrEmpty(PersonalData.Numar_CI))
            {
                <div class="detail-card">
                    <div class="card-header">
                        <i class="fas fa-id-badge"></i>
                        <h3>Documente Identitate</h3>
                    </div>
                    <div class="card-content">
                        <div class="form-grid">
                            <div class="form-field">
                                <label>Serie CI</label>
                                <span class="field-value">@(PersonalData.Serie_CI ?? "Nu este specificată")</span>
                            </div>
                            <div class="form-field">
                                <label>Număr CI</label>
                                <span class="field-value">@(PersonalData.Numar_CI ?? "Nu este specificat")</span>
                            </div>
                            <div class="form-field">
                                <label>Eliberat de</label>
                                <span class="field-value">@(PersonalData.Eliberat_CI_De ?? "Nu este specificat")</span>
                            </div>
                            <div class="form-field">
                                <label>Data Eliberării</label>
                                <span class="field-value">@(PersonalData.Data_Eliberare_CI?.ToString("dd.MM.yyyy") ?? "Nu este specificată")</span>
                            </div>
                            @if (PersonalData.Valabil_CI_Pana.HasValue)
                            {
                                <div class="form-field full-width">
                                    <label>Valabil până la</label>
                                    <span class="field-value document-validity">
                                        @PersonalData.Valabil_CI_Pana.Value.ToString("dd.MM.yyyy")
                                        @if (PersonalData.Valabil_CI_Pana.Value < DateTime.Now)
                                        {
                                            <span class="validity-badge expired">Expirat</span>
                                        }
                                        else if (PersonalData.Valabil_CI_Pana.Value < DateTime.Now.AddMonths(6))
                                        {
                                            <span class="validity-badge warning">Expiră în 6 luni</span>
                                        }
                                        else
                                        {
                                            <span class="validity-badge valid">Valid</span>
                                        }
                                    </span>
                                </div>
                            }
                        </div>
                    </div>
                </div>
            }

            @* System Information Section *@
            <div class="detail-card">
                <div class="card-header">
                    <i class="fas fa-calendar-alt"></i>
                    <h3>Informații Temporale</h3>
                </div>
                <div class="card-content">
                    <div class="form-grid">
                        <div class="form-field">
                            <label>Data angajării</label>
                            <span class="field-value">@PersonalData.Data_Crearii.ToString("dd.MM.yyyy HH:mm")</span>
                        </div>
                        <div class="form-field">
                            <label>Vechime în sistem</label>
                            <span class="field-value">@GetSystemAge(PersonalData.Data_Crearii)</span>
                        </div>
                        <div class="form-field">
                            <label>Creat de</label>
                            <span class="field-value">@(PersonalData.Creat_De ?? "SYSTEM")</span>
                        </div>
                        <div class="form-field">
                            <label>Ultima modificare</label>
                            <span class="field-value">@PersonalData.Data_Ultimei_Modificari.ToString("dd.MM.yyyy HH:mm")</span>
                        </div>
                    </div>
                </div>
            </div>

            @* Observations Section *@
            @if (!string.IsNullOrEmpty(PersonalData.Observatii))
            {
                <div class="detail-card observations-card">
                    <div class="card-header">
                        <i class="fas fa-sticky-note"></i>
                        <h3>Observații</h3>
                    </div>
                    <div class="card-content">
                        <div class="observations-content">
                            @PersonalData.Observatii
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>
