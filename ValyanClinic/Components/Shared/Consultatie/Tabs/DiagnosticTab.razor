@*
    Tab pentru Diagnostic & Tratament
    ✅ UPDATED: Split in diagnostic principal + diagnostice secundare cu coduri ICD-10
*@
@using ValyanClinic.Components.Shared.Consultatie

<div class="tab-content-section">
    <div class="section-title">
        <i class="fas fa-diagnoses"></i>
        <h4>Diagnostic & Tratament</h4>
    </div>
    
    <!-- ==================== SECȚIUNEA 1: DIAGNOSTIC PRINCIPAL (SIMPLIFICAT) ==================== -->
    
    <div class="form-section">
        <PrimaryDiagnosisSelector @bind-SelectedCode="PrimaryDiagnosisCode"
                                  @bind-DiagnosisDetails="PrimaryDiagnosisDetails"
                                  CurrentUserId="@CurrentUserId"
                                  ShowValidation="@ShowValidation"
                                  OnChanged="@OnFieldChanged" />
    </div>

    <!-- ==================== SECȚIUNEA 2: DIAGNOSTICE SECUNDARE (MAX 10) ==================== -->
    
    <div class="form-section">
        <SecondaryDiagnosesList @bind-SecondaryDiagnoses="SecondaryDiagnosesList"
                                CurrentUserId="@CurrentUserId"
                                ShowValidation="@ShowValidation"
                                OnChanged="@OnFieldChanged" />
    </div>
    
    <!-- ==================== SECȚIUNEA 3: DIAGNOSTICE TEXTUALE (OPȚIONALE) ==================== -->
    
    <div class="form-section">
        <div class="section-subtitle">
            <i class="fas fa-notes-medical"></i>
            <h5>Diagnostice Descriptive (Opționale)</h5>
        </div>
        
        @* Diagnostic Diferențial *@
        <div class="form-group">
            <label class="form-label">
                Diagnostic diferențial
            </label>
            <textarea class="form-control" 
                      rows="3"
                      placeholder="Liste diagnostice alternative care trebuie excluse..."
                      @bind="Model.DiagnosticDiferential"
                      @oninput="OnFieldChanged">
            </textarea>
            <small class="form-text text-muted">
                <i class="fas fa-info-circle"></i>
                Diagnostice cu simptomatologie similară care trebuie luate în considerare
            </small>
        </div>
    
        @* Diagnostic Etiologic *@
        <div class="form-group">
            <label class="form-label">
                Diagnostic etiologic
            </label>
            <textarea class="form-control" 
                      rows="2"
                      placeholder="Cauza bolii (ex: infecțioasă, traumatică, genetică...)..."
                      @bind="Model.DiagnosticEtiologic"
                      @oninput="OnFieldChanged">
            </textarea>
        </div>
    </div>
    
    <!-- Section Completed Indicator -->
    @if (OnSectionCompleted.HasDelegate && IsComplete)
    {
        <div class="section-complete-indicator">
            <i class="fas fa-check-circle"></i>
            <span>Secțiune completată</span>
        </div>
    }
</div>
