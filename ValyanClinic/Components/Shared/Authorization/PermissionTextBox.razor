@namespace ValyanClinic.Components.Shared.Authorization
@using ValyanClinic.Application.Interfaces
@using Syncfusion.Blazor.Inputs

@* 
    PermissionTextBox - TextBox cu verificare automată de permisiuni la nivel de câmp.
    Ascunde câmpul sau îl face readonly automat în funcție de permisiunile utilizatorului.
    
    Utilizare:
    <PermissionTextBox Entity="Pacient" Field="CNP" @bind-Value="Model.CNP" />
*@

@if (_fieldState != FieldState.Hidden)
{
    <div class="form-group @CssClass">
        @if (!string.IsNullOrEmpty(Label))
        {
            <label for="@Id">
                @if (Required)
                {
                    <span class="required">*</span>
                }
                @Label
            </label>
        }
        
        <SfTextBox @ref="_textBox"
                   ID="@Id"
                   @bind-Value="Value"
                   Placeholder="@Placeholder"
                   Readonly="@IsReadOnly"
                   Enabled="@IsEnabled"
                   MaxLength="@MaxLength"
                   Multiline="@Multiline"
                   RowCount="@RowCount"
                   CssClass="@GetInputCssClass()">
        </SfTextBox>
        
        @if (!string.IsNullOrEmpty(HelpText))
        {
            <small class="form-text text-muted">@HelpText</small>
        }
        
        @if (_fieldState == FieldState.ReadOnly && ShowReadOnlyMessage)
        {
            <small class="form-text text-warning">
                <i class="fas fa-lock"></i> Nu aveți permisiunea de a edita acest câmp
            </small>
        }
    </div>
}
