<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultație Medicală - ValyanClinic</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        :root {
            --primary: #0A6E7C;
            --primary-light: #12919F;
            --primary-dark: #085460;
            --accent: #00C9A7;
            --accent-glow: rgba(0, 201, 167, 0.15);
            --warning: #F59E0B;
            --danger: #EF4444;
            --success: #10B981;
            --bg-main: #F0F4F7;
            --bg-card: #FFFFFF;
            --bg-section: #F8FAFB;
            --text-primary: #1E293B;
            --text-secondary: #64748B;
            --text-muted: #94A3B8;
            --border: #E2E8F0;
            --border-focus: #0A6E7C;
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.06);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.08);
            --radius-sm: 6px;
            --radius-md: 10px;
            --radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg-main);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        .app-container {
            display: grid;
            grid-template-columns: 260px 1fr;
            min-height: 100vh;
        }

        /* ===== SIDEBAR ===== */
        .sidebar {
            background: linear-gradient(180deg, var(--primary-dark) 0%, var(--primary) 100%);
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            position: sticky;
            top: 0;
            height: 100vh;
        }

        .sidebar-logo {
            padding: 0 20px 24px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-logo h1 {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1.35rem;
            font-weight: 700;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-logo h1 i {
            font-size: 1.1rem;
            color: var(--accent);
        }

        .sidebar-logo span {
            font-size: 0.65rem;
            font-weight: 400;
            color: rgba(255,255,255,0.5);
            display: block;
            margin-top: 2px;
        }

        .sidebar-nav {
            flex: 1;
            padding: 20px 12px;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .nav-section-title {
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: rgba(255,255,255,0.4);
            padding: 0 12px 6px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 14px;
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            border-radius: var(--radius-md);
            transition: all 0.2s ease;
            margin-bottom: 2px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .nav-item:hover {
            background: rgba(255,255,255,0.08);
            color: #fff;
        }

        .nav-item.active {
            background: rgba(0, 201, 167, 0.2);
            color: var(--accent);
            font-weight: 500;
        }

        .nav-item i {
            width: 18px;
            text-align: center;
            font-size: 0.9rem;
        }

        .sidebar-footer {
            padding: 14px 20px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .doctor-badge {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .doctor-avatar {
            width: 38px;
            height: 38px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary-light) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .doctor-info h4 {
            color: #fff;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .doctor-info span {
            color: rgba(255,255,255,0.6);
            font-size: 0.7rem;
        }

        /* ===== MAIN CONTENT ===== */
        .main-content {
            padding: 24px 32px;
            overflow-y: auto;
        }

        /* ===== HEADER ===== */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 24px;
        }

        .page-title h2 {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .page-title p {
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .header-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            padding: 9px 16px;
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-outline {
            background: var(--bg-card);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-outline:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn-primary {
            background: var(--primary);
            color: #fff;
            box-shadow: 0 2px 8px rgba(10, 110, 124, 0.3);
        }

        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .btn-success {
            background: var(--success);
            color: #fff;
        }

        .btn-success:hover {
            background: #0D9668;
        }

        /* ===== PATIENT CARD ===== */
        .patient-card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 18px 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-md);
            display: flex;
            align-items: center;
            gap: 18px;
            position: relative;
            overflow: hidden;
        }

        .patient-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: linear-gradient(180deg, var(--primary) 0%, var(--accent) 100%);
        }

        .patient-avatar {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: linear-gradient(135deg, #E0F2FE 0%, #BAE6FD 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .patient-avatar i {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .patient-details {
            flex: 1;
        }

        .patient-name {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .patient-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            margin-top: 6px;
        }

        .patient-meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .patient-meta-item i {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        .patient-tags {
            display: flex;
            gap: 6px;
        }

        .tag {
            padding: 5px 10px;
            border-radius: 16px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .tag-warning {
            background: #FEF3C7;
            color: #92400E;
        }

        .tag-info {
            background: #DBEAFE;
            color: #1E40AF;
        }

        /* ===== TABS ===== */
        .tabs-container {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            overflow: hidden;
        }

        .tabs-header {
            display: flex;
            background: var(--bg-section);
            border-bottom: 1px solid var(--border);
        }

        .tab-btn {
            flex: 1;
            padding: 14px 20px;
            background: transparent;
            border: none;
            font-family: inherit;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-secondary);
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .tab-btn:hover {
            color: var(--primary);
            background: rgba(10, 110, 124, 0.05);
        }

        .tab-btn.active {
            color: var(--primary);
            background: var(--bg-card);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 3px 3px 0 0;
        }

        .tab-btn i {
            font-size: 0.9rem;
        }

        .tab-number {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-muted);
        }

        .tab-btn.active .tab-number {
            background: var(--primary);
            color: #fff;
        }

        .tabs-content {
            padding: 28px;
        }

        .tab-panel {
            display: none;
        }

        .tab-panel.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(6px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== FORM ELEMENTS ===== */
        .form-section {
            margin-bottom: 28px;
        }

        .form-section:last-child {
            margin-bottom: 0;
        }

        .section-title {
            font-family: 'Plus Jakarta Sans', sans-serif;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title i {
            color: var(--primary);
            font-size: 1rem;
        }

        .section-divider {
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, var(--border) 0%, transparent 100%);
            margin: 28px 0;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-row:last-child {
            margin-bottom: 0;
        }

        .form-group {
            position: relative;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-secondary);
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.03em;
        }

        .form-label.required::after {
            content: '*';
            color: var(--danger);
            margin-left: 3px;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 10px 14px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-md);
            font-family: inherit;
            font-size: 0.875rem;
            color: var(--text-primary);
            background: var(--bg-card);
            transition: all 0.2s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(10, 110, 124, 0.1);
        }

        .form-input::placeholder {
            color: var(--text-muted);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
            line-height: 1.5;
        }

        .form-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 16px;
            padding-right: 40px;
        }

        /* ===== EXAM GRID - Examen Clinic General ===== */
        .exam-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 14px;
        }

        .exam-item {
            background: var(--bg-section);
            border-radius: var(--radius-md);
            padding: 14px;
            border: 1px solid var(--border);
            transition: all 0.2s ease;
        }

        .exam-item:hover {
            border-color: var(--primary);
        }

        .exam-item-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .exam-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-glow) 0%, rgba(10, 110, 124, 0.1) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .exam-icon i {
            color: var(--primary);
            font-size: 0.85rem;
        }

        .exam-label {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            color: var(--text-muted);
        }

        .exam-input-row {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .exam-input {
            flex: 1;
            padding: 8px 10px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--text-primary);
            text-align: center;
        }

        .exam-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .exam-unit {
            font-size: 0.75rem;
            color: var(--text-muted);
            min-width: 40px;
        }

        .exam-select {
            width: 100%;
            padding: 8px 10px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            color: var(--text-primary);
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 14px;
            padding-right: 30px;
        }

        .exam-select:focus {
            outline: none;
            border-color: var(--primary);
        }

        /* ===== CHECKBOX & RADIO GROUPS ===== */
        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 6px;
            cursor: pointer;
        }

        .checkbox-item input[type="checkbox"] {
            width: 16px;
            height: 16px;
            border: 2px solid var(--border);
            border-radius: 4px;
            appearance: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .checkbox-item input[type="checkbox"]:checked {
            background: var(--primary);
            border-color: var(--primary);
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='white' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='20 6 9 17 4 12'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
        }

        .checkbox-item span {
            font-size: 0.8rem;
            color: var(--text-primary);
        }

        /* ===== EXPANDABLE SECTIONS ===== */
        .expandable-section {
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            margin-bottom: 10px;
            overflow: hidden;
        }

        .expandable-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 16px;
            background: var(--bg-section);
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .expandable-header:hover {
            background: #EEF2F5;
        }

        .expandable-header h4 {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .expandable-header h4 i {
            color: var(--primary);
            font-size: 0.9rem;
        }

        .expandable-toggle {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--bg-card);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .expandable-toggle i {
            color: var(--text-muted);
            font-size: 0.7rem;
            transition: transform 0.3s ease;
        }

        .expandable-section.open .expandable-toggle i {
            transform: rotate(180deg);
        }

        .expandable-content {
            padding: 16px;
            background: var(--bg-card);
            display: none;
        }

        .expandable-section.open .expandable-content {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ===== DIAGNOSIS SECTION - Updated ===== */
        .diagnosis-cards {
            display: grid;
            gap: 14px;
        }

        .diagnosis-card {
            background: var(--bg-section);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            overflow: hidden;
        }

        .diagnosis-card-header {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 16px;
            border-bottom: 1px solid var(--border);
        }

        .diagnosis-type {
            padding: 4px 10px;
            border-radius: 5px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.04em;
            white-space: nowrap;
        }

        .diagnosis-type.principal {
            background: var(--primary);
            color: #fff;
        }

        .diagnosis-type.secundar {
            background: #E0E7FF;
            color: #4338CA;
        }

        .diagnosis-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .diagnosis-code-input {
            width: 80px;
            padding: 6px 10px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-family: 'Plus Jakarta Sans', monospace;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--primary);
            text-align: center;
        }

        .diagnosis-code-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .diagnosis-name-input {
            flex: 1;
            padding: 6px 12px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 0.875rem;
            color: var(--text-primary);
        }

        .diagnosis-name-input:focus {
            outline: none;
            border-color: var(--primary);
        }

        .diagnosis-actions {
            display: flex;
            gap: 6px;
        }

        .diagnosis-card-body {
            padding: 12px 16px;
            background: var(--bg-card);
        }

        .diagnosis-details-label {
            font-size: 0.7rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            color: var(--text-muted);
            margin-bottom: 6px;
        }

        .diagnosis-details-textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-family: inherit;
            font-size: 0.85rem;
            color: var(--text-primary);
            min-height: 70px;
            resize: vertical;
            line-height: 1.5;
        }

        .diagnosis-details-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(10, 110, 124, 0.1);
        }

        .diagnosis-details-textarea::placeholder {
            color: var(--text-muted);
        }

        .btn-icon {
            width: 28px;
            height: 28px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border);
            background: var(--bg-card);
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 0.75rem;
        }

        .btn-icon:hover {
            border-color: var(--danger);
            color: var(--danger);
            background: #FEF2F2;
        }

        .add-btn {
            width: 100%;
            padding: 12px;
            border: 2px dashed var(--border);
            border-radius: var(--radius-md);
            background: transparent;
            color: var(--text-muted);
            font-family: inherit;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .add-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: rgba(10, 110, 124, 0.03);
        }

        /* ===== ICD SEARCH ===== */
        .icd-search-container {
            position: relative;
            margin-bottom: 16px;
        }

        .icd-search-input {
            width: 100%;
            padding: 10px 14px 10px 40px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-md);
            font-size: 0.875rem;
        }

        .icd-search-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(10, 110, 124, 0.1);
        }

        .icd-search-icon {
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            font-size: 0.85rem;
        }

        /* ===== FOOTER ACTIONS ===== */
        .form-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 28px;
            background: var(--bg-section);
            border-top: 1px solid var(--border);
            margin: 0 -28px -28px;
        }

        .footer-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-right {
            display: flex;
            gap: 10px;
        }

        .autosave-indicator {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .autosave-indicator i {
            color: var(--success);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 1200px) {
            .exam-grid {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .app-container {
                grid-template-columns: 1fr;
            }

            .sidebar {
                display: none;
            }

            .main-content {
                padding: 16px;
            }
        }

        @media (max-width: 768px) {
            .tab-btn span {
                display: none;
            }

            .tab-btn {
                padding: 12px 16px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .exam-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* ===== TOAST NOTIFICATIONS ===== */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 14px 18px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 280px;
            max-width: 400px;
            animation: slideInRight 0.3s ease;
            border-left: 4px solid var(--primary);
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .toast.success .toast-icon {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .toast.warning .toast-icon {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .toast.error .toast-icon {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .toast-content {
            flex: 1;
        }

        .toast-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .toast-message {
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            font-size: 0.9rem;
            transition: color 0.2s;
        }

        .toast-close:hover {
            color: var(--text-primary);
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(100px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideOutRight {
            from { opacity: 1; transform: translateX(0); }
            to { opacity: 0; transform: translateX(100px); }
        }

        .toast.hiding {
            animation: slideOutRight 0.3s ease forwards;
        }

        /* ===== MOBILE MENU ===== */
        .mobile-header {
            display: none;
            background: var(--primary);
            padding: 12px 16px;
            align-items: center;
            justify-content: space-between;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .mobile-header h1 {
            color: #fff;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .mobile-header h1 i {
            color: var(--accent);
        }

        .mobile-menu-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            color: #fff;
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 1.2rem;
            transition: background 0.2s;
        }

        .mobile-menu-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .sidebar-overlay.active {
            display: block;
            opacity: 1;
        }

        /* ===== PROGRESS INDICATOR FOR TABS ===== */
        .tab-btn.completed .tab-number {
            background: var(--success);
            color: #fff;
        }

        .tab-btn.completed .tab-number::before {
            content: '✓';
            font-size: 0.6rem;
        }

        /* ===== IMC INDICATOR ===== */
        .imc-indicator {
            font-size: 0.65rem;
            padding: 2px 6px;
            border-radius: 4px;
            margin-left: 4px;
            font-weight: 500;
        }

        .imc-indicator.underweight {
            background: #DBEAFE;
            color: #1E40AF;
        }

        .imc-indicator.normal {
            background: #D1FAE5;
            color: #065F46;
        }

        .imc-indicator.overweight {
            background: #FEF3C7;
            color: #92400E;
        }

        .imc-indicator.obese {
            background: #FEE2E2;
            color: #991B1B;
        }

        /* ===== RESPONSIVE UPDATES ===== */
        @media (max-width: 992px) {
            .mobile-header {
                display: flex;
            }

            .sidebar {
                position: fixed;
                left: -280px;
                top: 0;
                bottom: 0;
                width: 280px;
                z-index: 1000;
                transition: left 0.3s ease;
                display: flex;
            }

            .sidebar.open {
                left: 0;
            }

            .main-content {
                padding-top: 0;
            }
        }

        @media (max-width: 768px) {
            .patient-card {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .patient-tags {
                width: 100%;
                flex-wrap: wrap;
            }

            .diagnosis-card-header {
                flex-wrap: wrap;
            }

            .diagnosis-info {
                width: 100%;
                flex-direction: column;
                gap: 8px;
            }

            .diagnosis-code-input {
                width: 100%;
            }
        }

        /* ========================================
           FAZA 2: ANIMAȚII ȘI EFECTE ÎMBUNĂTĂȚITE
           ======================================== */

        /* ===== KEYFRAME ANIMATIONS ===== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes ripple {
            to {
                transform: translate(-50%, -50%) scale(4);
                opacity: 0;
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* ===== STAGGERED ENTRY ANIMATIONS ===== */
        .page-header {
            animation: fadeInUp 0.5s ease forwards;
        }

        .patient-card {
            animation: fadeInUp 0.5s ease 0.1s both;
        }

        .tabs-container {
            animation: fadeInUp 0.5s ease 0.2s both;
        }

        .form-section {
            animation: fadeInUp 0.4s ease both;
        }

        .form-section:nth-child(1) { animation-delay: 0.1s; }
        .form-section:nth-child(2) { animation-delay: 0.2s; }
        .form-section:nth-child(3) { animation-delay: 0.3s; }
        .form-section:nth-child(4) { animation-delay: 0.4s; }

        .exam-item {
            animation: fadeInScale 0.3s ease both;
        }

        .exam-item:nth-child(1) { animation-delay: 0.05s; }
        .exam-item:nth-child(2) { animation-delay: 0.1s; }
        .exam-item:nth-child(3) { animation-delay: 0.15s; }
        .exam-item:nth-child(4) { animation-delay: 0.2s; }
        .exam-item:nth-child(5) { animation-delay: 0.25s; }
        .exam-item:nth-child(6) { animation-delay: 0.3s; }
        .exam-item:nth-child(7) { animation-delay: 0.35s; }
        .exam-item:nth-child(8) { animation-delay: 0.4s; }
        .exam-item:nth-child(9) { animation-delay: 0.45s; }
        .exam-item:nth-child(10) { animation-delay: 0.5s; }
        .exam-item:nth-child(11) { animation-delay: 0.55s; }
        .exam-item:nth-child(12) { animation-delay: 0.6s; }

        .diagnosis-card {
            animation: slideInLeft 0.4s ease both;
        }

        .diagnosis-card:nth-child(1) { animation-delay: 0.1s; }
        .diagnosis-card:nth-child(2) { animation-delay: 0.2s; }
        .diagnosis-card:nth-child(3) { animation-delay: 0.3s; }

        .expandable-section {
            animation: fadeInUp 0.3s ease both;
        }

        .expandable-section:nth-child(1) { animation-delay: 0.1s; }
        .expandable-section:nth-child(2) { animation-delay: 0.15s; }
        .expandable-section:nth-child(3) { animation-delay: 0.2s; }
        .expandable-section:nth-child(4) { animation-delay: 0.25s; }

        .nav-item {
            animation: slideInLeft 0.3s ease both;
        }

        .nav-section:first-child .nav-item:nth-child(1) { animation-delay: 0.1s; }
        .nav-section:first-child .nav-item:nth-child(2) { animation-delay: 0.15s; }
        .nav-section:first-child .nav-item:nth-child(3) { animation-delay: 0.2s; }
        .nav-section:first-child .nav-item:nth-child(4) { animation-delay: 0.25s; }
        .nav-section:last-child .nav-item:nth-child(1) { animation-delay: 0.3s; }
        .nav-section:last-child .nav-item:nth-child(2) { animation-delay: 0.35s; }
        .nav-section:last-child .nav-item:nth-child(3) { animation-delay: 0.4s; }

        /* ===== ENHANCED BUTTON EFFECTS ===== */
        .btn {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
        }

        .btn:active::after {
            animation: ripple 0.6s ease-out;
        }

        .btn-outline:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(10, 110, 124, 0.15);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-dark) 0%, var(--primary) 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 20px rgba(10, 110, 124, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #059669 0%, var(--success) 100%);
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        /* ===== ENHANCED PATIENT CARD ===== */
        .patient-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .patient-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.1);
        }

        .patient-card::before {
            transition: width 0.3s ease;
        }

        .patient-card:hover::before {
            width: 6px;
        }

        .patient-avatar {
            transition: all 0.3s ease;
        }

        .patient-card:hover .patient-avatar {
            transform: scale(1.08);
            box-shadow: 0 4px 15px rgba(10, 110, 124, 0.3);
        }

        /* ===== ENHANCED TAG EFFECTS ===== */
        .tag {
            transition: all 0.3s ease;
        }

        .tag:hover {
            transform: scale(1.05);
        }

        .tag-warning:hover {
            background: #FDE68A;
            box-shadow: 0 2px 8px rgba(245, 158, 11, 0.3);
        }

        .tag-info:hover {
            background: #BFDBFE;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        /* ===== ENHANCED TAB EFFECTS ===== */
        .tab-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .tab-btn .tab-number {
            transition: all 0.3s ease;
        }

        .tab-btn:hover .tab-number {
            transform: scale(1.1);
            background: rgba(10, 110, 124, 0.2);
            color: var(--primary);
        }

        .tab-panel.active {
            animation: fadeIn 0.4s ease;
        }

        /* ===== ENHANCED EXAM ITEMS ===== */
        .exam-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .exam-item:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(10, 110, 124, 0.12);
        }

        .exam-icon {
            transition: all 0.3s ease;
        }

        .exam-item:hover .exam-icon {
            transform: scale(1.1) rotate(5deg);
            background: linear-gradient(135deg, var(--accent) 0%, var(--primary-light) 100%);
        }

        .exam-item:hover .exam-icon i {
            color: #fff;
        }

        .exam-input,
        .exam-select {
            transition: all 0.2s ease;
        }

        .exam-input:focus,
        .exam-select:focus {
            transform: scale(1.02);
            box-shadow: 0 0 0 3px rgba(10, 110, 124, 0.1);
        }

        /* ===== ENHANCED EXPANDABLE SECTIONS ===== */
        .expandable-header {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .expandable-header:hover {
            padding-left: 20px;
        }

        .expandable-toggle {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .expandable-header:hover .expandable-toggle {
            background: var(--primary);
            border-color: var(--primary);
        }

        .expandable-header:hover .expandable-toggle i {
            color: #fff;
        }

        /* ===== ENHANCED DIAGNOSIS CARDS ===== */
        .diagnosis-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .diagnosis-card:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(10, 110, 124, 0.15);
        }

        .diagnosis-type {
            transition: all 0.3s ease;
        }

        .diagnosis-card:hover .diagnosis-type {
            transform: scale(1.05);
        }

        /* ===== ENHANCED ADD BUTTON ===== */
        .add-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .add-btn i {
            transition: transform 0.3s ease;
        }

        .add-btn:hover {
            border-style: solid;
            transform: scale(1.01);
            box-shadow: 0 4px 15px rgba(10, 110, 124, 0.1);
        }

        .add-btn:hover i {
            transform: rotate(90deg);
        }

        /* ===== ENHANCED ICON BUTTON ===== */
        .btn-icon {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .btn-icon:hover {
            transform: scale(1.1) rotate(5deg);
        }

        /* ===== ENHANCED NAVIGATION ===== */
        .nav-item {
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: var(--accent);
            transform: scaleY(0);
            transition: transform 0.3s ease;
        }

        .nav-item:hover::before {
            transform: scaleY(1);
        }

        .nav-item:hover {
            padding-left: 18px;
        }

        .nav-item i {
            transition: transform 0.3s ease;
        }

        .nav-item:hover i {
            transform: scale(1.15);
        }

        /* ===== ENHANCED DOCTOR BADGE ===== */
        .doctor-avatar {
            transition: all 0.3s ease;
        }

        .doctor-badge:hover .doctor-avatar {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0, 201, 167, 0.4);
        }

        /* ===== ENHANCED FORM INPUTS ===== */
        .form-input,
        .form-select,
        .form-textarea {
            transition: all 0.2s ease;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            transform: translateY(-1px);
            box-shadow: 0 0 0 4px rgba(10, 110, 124, 0.12), 0 2px 8px rgba(10, 110, 124, 0.1);
        }

        /* ===== ENHANCED MEDICATION TABLE ===== */
        .medication-table tbody tr {
            transition: all 0.3s ease;
        }

        .medication-table tbody tr:hover {
            background: rgba(10, 110, 124, 0.03);
        }

        .med-icon {
            transition: all 0.3s ease;
        }

        .medication-table tbody tr:hover .med-icon {
            transform: scale(1.1) rotate(5deg);
        }

        /* ===== ENHANCED CHECKBOX ===== */
        .checkbox-item {
            transition: all 0.2s ease;
        }

        .checkbox-item:hover span {
            color: var(--primary);
        }

        .checkbox-item:hover input[type="checkbox"] {
            border-color: var(--primary);
        }

        .checkbox-item input[type="checkbox"] {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .checkbox-item input[type="checkbox"]:checked {
            transform: scale(1.1);
        }

        /* ===== AUTOSAVE INDICATOR PULSE ===== */
        .autosave-indicator i {
            animation: pulse 2s ease-in-out infinite;
        }

        /* ========================================
           FAZA 3: FUNCȚIONALITĂȚI AVANSATE
           ======================================== */

        /* ===== PROGRESS BAR PENTRU TAB-URI ===== */
        .tabs-progress {
            height: 4px;
            background: var(--border);
            position: relative;
            overflow: hidden;
        }

        .tabs-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .tabs-progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(
                90deg,
                transparent 0%,
                rgba(255, 255, 255, 0.4) 50%,
                transparent 100%
            );
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ===== IMC INDICATOR ÎMBUNĂTĂȚIT ===== */
        .imc-result {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 6px;
        }

        .imc-badge {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.65rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            animation: fadeInScale 0.3s ease;
        }

        .imc-badge.underweight {
            background: linear-gradient(135deg, #DBEAFE 0%, #BFDBFE 100%);
            color: #1E40AF;
        }

        .imc-badge.normal {
            background: linear-gradient(135deg, #D1FAE5 0%, #A7F3D0 100%);
            color: #065F46;
        }

        .imc-badge.overweight {
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            color: #92400E;
        }

        .imc-badge.obese {
            background: linear-gradient(135deg, #FCA5A5 0%, #EF4444 100%);
            color: #991B1B;
        }

        .imc-badge.obese-severe {
            background: linear-gradient(135deg, #FEE2E2 0%, #F87171 100%);
            color: #7F1D1D;
        }

        .imc-badge i {
            font-size: 0.6rem;
        }

        /* IMC Scale Visual */
        .imc-scale {
            display: flex;
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 8px;
            background: var(--border);
        }

        .imc-scale-segment {
            height: 100%;
            transition: opacity 0.3s ease;
        }

        .imc-scale-segment.underweight { 
            width: 18.5%; 
            background: linear-gradient(90deg, #93C5FD, #3B82F6); 
        }
        .imc-scale-segment.normal { 
            width: 24.9%; 
            background: linear-gradient(90deg, #6EE7B7, #10B981); 
        }
        .imc-scale-segment.overweight { 
            width: 29.9%; 
            background: linear-gradient(90deg, #FCD34D, #F59E0B); 
        }
        .imc-scale-segment.obese { 
            width: 26.7%; 
            background: linear-gradient(90deg, #FCA5A5, #EF4444); 
        }

        .imc-scale-marker {
            position: absolute;
            width: 3px;
            height: 10px;
            background: var(--text-primary);
            border-radius: 2px;
            top: -2px;
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .imc-scale-container {
            position: relative;
            margin-top: 8px;
        }

        .imc-scale-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 4px;
            font-size: 0.6rem;
            color: var(--text-muted);
        }

        /* ===== KEYBOARD SHORTCUTS HINT ===== */
        .keyboard-hint {
            position: fixed;
            bottom: 24px;
            left: 24px;
            background: var(--bg-card);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 100;
            border: 1px solid var(--border);
        }

        .keyboard-hint.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .keyboard-hint kbd {
            background: var(--bg-section);
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 2px 6px;
            font-family: 'Plus Jakarta Sans', monospace;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-primary);
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }

        .keyboard-hint-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px;
            margin-left: 8px;
            font-size: 0.8rem;
            transition: color 0.2s;
        }

        .keyboard-hint-close:hover {
            color: var(--text-primary);
        }

        /* ===== CONSULTATION TIMER ===== */
        .consultation-timer {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            background: var(--bg-section);
            border-radius: var(--radius-md);
            border: 1px solid var(--border);
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .consultation-timer i {
            color: var(--primary);
        }

        .consultation-timer .time {
            font-family: 'Plus Jakarta Sans', monospace;
            font-weight: 600;
            color: var(--text-primary);
        }

        .consultation-timer.warning .time {
            color: var(--warning);
        }

        .consultation-timer.danger .time {
            color: var(--danger);
            animation: pulse 1s ease-in-out infinite;
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== MEDICATION INPUT HIGHLIGHT ===== */
        .medication-table .form-input.allergy-match {
            border-color: var(--danger);
            background: #FEF2F2;
            animation: pulseRed 1s ease-in-out infinite;
        }

        @keyframes pulseRed {
            0%, 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 0 0 4px rgba(239, 68, 68, 0.1); }
        }

        /* ===== TIMER ENHANCEMENTS ===== */
        .consultation-timer {
            position: relative;
        }

        .consultation-timer::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: var(--primary);
            border-radius: 3px 0 0 3px;
            transition: background 0.3s ease;
        }

        .consultation-timer.warning::before {
            background: var(--warning);
        }

        .consultation-timer.danger::before {
            background: var(--danger);
        }

        .timer-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            right: 0;
            background: var(--text-primary);
            color: #fff;
            padding: 6px 10px;
            border-radius: var(--radius-sm);
            font-size: 0.7rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-5px);
            transition: all 0.2s ease;
            z-index: 100;
        }

        .timer-tooltip::before {
            content: '';
            position: absolute;
            bottom: 100%;
            right: 12px;
            border: 5px solid transparent;
            border-bottom-color: var(--text-primary);
        }

        .consultation-timer:hover .timer-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        /* ========================================
           FAZA 4: MICROINTERACȚIUNI ȘI POLISH
           ======================================== */

        /* ===== CHARACTER COUNTER ===== */
        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.65rem;
            color: var(--text-muted);
            background: var(--bg-card);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .char-counter.warning {
            color: var(--warning);
            font-weight: 600;
        }

        .char-counter.danger {
            color: var(--danger);
            font-weight: 600;
            animation: pulse 1s ease-in-out infinite;
        }

        .form-textarea.has-counter {
            padding-bottom: 28px;
        }

        /* ===== ALLERGY ALERT BANNER ===== */
        .allergy-alert {
            display: none;
            background: linear-gradient(135deg, #FEF3C7 0%, #FDE68A 100%);
            border: 2px solid var(--warning);
            border-radius: var(--radius-md);
            padding: 12px 16px;
            margin-bottom: 16px;
            animation: alertPulse 2s ease-in-out infinite;
        }

        .allergy-alert.active {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .allergy-alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--warning);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            animation: shake 0.5s ease-in-out;
        }

        .allergy-alert-icon i {
            color: #fff;
            font-size: 1.1rem;
        }

        .allergy-alert-content {
            flex: 1;
        }

        .allergy-alert-title {
            font-weight: 700;
            color: #92400E;
            font-size: 0.9rem;
            margin-bottom: 2px;
        }

        .allergy-alert-message {
            font-size: 0.8rem;
            color: #B45309;
        }

        .allergy-alert-close {
            background: none;
            border: none;
            color: #92400E;
            cursor: pointer;
            padding: 4px;
            font-size: 1rem;
            opacity: 0.7;
            transition: opacity 0.2s;
        }

        .allergy-alert-close:hover {
            opacity: 1;
        }

        @keyframes alertPulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); }
            50% { box-shadow: 0 0 0 8px rgba(245, 158, 11, 0); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-5px); }
            40% { transform: translateX(5px); }
            60% { transform: translateX(-5px); }
            80% { transform: translateX(5px); }
        }

        /* ===== SCROLL TO TOP BUTTON ===== */
        .scroll-top-btn {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--primary);
            color: #fff;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--shadow-lg);
            opacity: 0;
            visibility: hidden;
            transform: translateY(20px);
            transition: all 0.3s ease;
            z-index: 100;
        }

        .scroll-top-btn.visible {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .scroll-top-btn:hover {
            background: var(--primary-dark);
            transform: translateY(-3px);
        }

        .scroll-top-btn i {
            font-size: 1rem;
        }
    </style>
</head>
<body>
    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Se salvează...</div>
    </div>

    <!-- Scroll to Top Button -->
    <button class="scroll-top-btn" id="scrollTopBtn" title="Înapoi sus">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Sidebar Overlay for Mobile -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Keyboard Shortcuts Hint -->
    <div class="keyboard-hint" id="keyboardHint">
        <span><kbd>Ctrl</kbd> + <kbd>S</kbd> Salvare</span>
        <span><kbd>Ctrl</kbd> + <kbd>→</kbd> Tab următor</span>
        <span><kbd>Ctrl</kbd> + <kbd>←</kbd> Tab anterior</span>
        <button class="keyboard-hint-close" onclick="hideKeyboardHint()"><i class="fas fa-times"></i></button>
    </div>

    <div class="app-container">
        <!-- Mobile Header -->
        <header class="mobile-header">
            <h1><i class="fas fa-heartbeat"></i> ValyanClinic</h1>
            <button class="mobile-menu-btn" id="mobileMenuBtn">
                <i class="fas fa-bars"></i>
            </button>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-logo">
                <h1>
                    <i class="fas fa-heartbeat"></i>
                    ValyanClinic
                    <span>Clinical Management System</span>
                </h1>
            </div>

            <nav class="sidebar-nav">
                <div class="nav-section">
                    <div class="nav-section-title">Principal</div>
                    <a class="nav-item" href="#"><i class="fas fa-th-large"></i> Dashboard</a>
                    <a class="nav-item" href="#"><i class="fas fa-calendar-alt"></i> Programări</a>
                    <a class="nav-item active" href="#"><i class="fas fa-stethoscope"></i> Consultații</a>
                    <a class="nav-item" href="#"><i class="fas fa-users"></i> Pacienți</a>
                </div>
                <div class="nav-section">
                    <div class="nav-section-title">Documente</div>
                    <a class="nav-item" href="#"><i class="fas fa-file-medical"></i> Scrisori Medicale</a>
                    <a class="nav-item" href="#"><i class="fas fa-prescription"></i> Rețete</a>
                    <a class="nav-item" href="#"><i class="fas fa-file-invoice"></i> Bilete Trimitere</a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="doctor-badge">
                    <div class="doctor-avatar">AP</div>
                    <div class="doctor-info">
                        <h4>Dr. Adrian Popescu</h4>
                        <span>Cardiologie</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="page-header">
                <div class="page-title">
                    <h2>Consultație Nouă</h2>
                    <p>Completează fișa de consultație pentru pacient</p>
                </div>
                <div class="header-actions">
                    <div class="consultation-timer" id="consultationTimer">
                        <i class="fas fa-clock"></i>
                        <span class="time" id="timerDisplay">00:00</span>
                        <div class="timer-tooltip" id="timerTooltip">Durată recomandată: 15-20 min</div>
                    </div>
                    <button class="btn btn-outline"><i class="fas fa-save"></i> Salvează Draft</button>
                    <button class="btn btn-primary"><i class="fas fa-file-medical"></i> Generează Scrisoare</button>
                </div>
            </header>

            <!-- Patient Card -->
            <section class="patient-card">
                <div class="patient-avatar"><i class="fas fa-user"></i></div>
                <div class="patient-details">
                    <h3 class="patient-name">Ionescu Maria</h3>
                    <div class="patient-meta">
                        <span class="patient-meta-item"><i class="fas fa-id-card"></i> CNP: 2850315123456</span>
                        <span class="patient-meta-item"><i class="fas fa-birthday-cake"></i> 39 ani</span>
                        <span class="patient-meta-item"><i class="fas fa-venus"></i> Feminin</span>
                        <span class="patient-meta-item"><i class="fas fa-phone"></i> 0721 234 567</span>
                    </div>
                </div>
                <div class="patient-tags">
                    <span class="tag tag-warning"><i class="fas fa-exclamation-triangle"></i> Alergie Penicilină</span>
                    <span class="tag tag-info"><i class="fas fa-heartbeat"></i> Hipertensiune</span>
                </div>
            </section>

            <!-- Tabs Container -->
            <div class="tabs-container">
                <!-- Progress Bar -->
                <div class="tabs-progress">
                    <div class="tabs-progress-bar" id="tabsProgressBar" style="width: 25%;"></div>
                </div>

                <div class="tabs-header">
                    <button class="tab-btn active">
                        <i class="fas fa-comment-medical"></i>
                        <span>Motiv & Antecedente</span>
                        <span class="tab-number">1</span>
                    </button>
                    <button class="tab-btn">
                        <i class="fas fa-stethoscope"></i>
                        <span>Examen Clinic & Investigații</span>
                        <span class="tab-number">2</span>
                    </button>
                    <button class="tab-btn">
                        <i class="fas fa-diagnoses"></i>
                        <span>Diagnostic & Tratament</span>
                        <span class="tab-number">3</span>
                    </button>
                    <button class="tab-btn">
                        <i class="fas fa-clipboard-check"></i>
                        <span>Concluzii</span>
                        <span class="tab-number">4</span>
                    </button>
                </div>

                <div class="tabs-content">
                    <!-- Tab 1: Motiv Prezentare & Antecedente -->
                    <div class="tab-panel active" id="tab-1">
                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-comment-medical"></i> Motivul Prezentării</h3>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label class="form-label required">Motivul principal al consultației</label>
                                    <textarea class="form-textarea" placeholder="Descrieți motivul prezentării pacientului..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-book-medical"></i> Istoricul Bolii Actuale</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Debut</label>
                                    <input type="text" class="form-input" placeholder="ex: brusc, insidios">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Data debut</label>
                                    <input type="date" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Evoluție</label>
                                    <select class="form-select">
                                        <option value="">Selectează...</option>
                                        <option>Progresivă</option>
                                        <option>Staționară</option>
                                        <option>Fluctuantă</option>
                                        <option>În remisiune</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label class="form-label">Descriere detaliată</label>
                                    <textarea class="form-textarea" placeholder="Descrieți detaliat evoluția și caracteristicile simptomelor..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-history"></i> Antecedente</h3>

                            <div class="expandable-section open">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-dna"></i> Antecedente Heredocolaterale</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group full-width">
                                            <label class="form-label">Afecțiuni în familie</label>
                                            <div class="checkbox-group">
                                                <label class="checkbox-item"><input type="checkbox"><span>Diabet zaharat</span></label>
                                                <label class="checkbox-item"><input type="checkbox"><span>HTA</span></label>
                                                <label class="checkbox-item"><input type="checkbox"><span>Boli cardiace</span></label>
                                                <label class="checkbox-item"><input type="checkbox"><span>Cancer</span></label>
                                                <label class="checkbox-item"><input type="checkbox"><span>Boli neurologice</span></label>
                                                <label class="checkbox-item"><input type="checkbox"><span>Boli psihice</span></label>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group full-width">
                                            <label class="form-label">Observații</label>
                                            <textarea class="form-textarea" rows="2" placeholder="Detalii suplimentare..."></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="expandable-section">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-baby"></i> Antecedente Fiziologice</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Condiții naștere</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>La termen, normal</option>
                                                <option>Prematur</option>
                                                <option>Cezariană</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Alimentație primul an</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Naturală</option>
                                                <option>Artificială</option>
                                                <option>Mixtă</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Menarhă (vârstă)</label>
                                            <input type="text" class="form-input" placeholder="ex: 13 ani">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="expandable-section">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-notes-medical"></i> Antecedente Patologice Personale</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group full-width">
                                            <label class="form-label">Afecțiuni cronice</label>
                                            <textarea class="form-textarea" rows="2" placeholder="Listați afecțiunile cronice..."></textarea>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Internări anterioare</label>
                                            <textarea class="form-textarea" rows="2" placeholder="Spitalizări, intervenții..."></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Medicație cronică</label>
                                            <textarea class="form-textarea" rows="2" placeholder="Tratamente curente..."></textarea>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group full-width">
                                            <label class="form-label">Alergii cunoscute</label>
                                            <input type="text" class="form-input" placeholder="Medicamente, alimente, substanțe...">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="expandable-section">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-home"></i> Condiții Socio-economice</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Ocupație</label>
                                            <input type="text" class="form-input" placeholder="Profesia">
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Mediu</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Urban</option>
                                                <option>Rural</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Condiții locuit</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Corespunzătoare</option>
                                                <option>Precare</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Fumat</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Nefumător</option>
                                                <option>Fumător activ</option>
                                                <option>Fost fumător</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Alcool</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Absent</option>
                                                <option>Ocazional</option>
                                                <option>Moderat</option>
                                                <option>Excesiv</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Activitate fizică</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Sedentară</option>
                                                <option>Moderată</option>
                                                <option>Activă</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 2: Examen Clinic & Investigații -->
                    <div class="tab-panel" id="tab-2">
                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-user-md"></i> Examen Clinic General</h3>
                            <div class="exam-grid">
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-user-check"></i></div>
                                        <div class="exam-label">Stare Generală</div>
                                    </div>
                                    <select class="exam-select">
                                        <option value="">Selectează...</option>
                                        <option>Bună</option>
                                        <option>Relativ bună</option>
                                        <option>Medie</option>
                                        <option>Alterată</option>
                                        <option>Gravă</option>
                                    </select>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-hand-paper"></i></div>
                                        <div class="exam-label">Tegumente</div>
                                    </div>
                                    <select class="exam-select">
                                        <option value="">Selectează...</option>
                                        <option>Normal colorate</option>
                                        <option>Palide</option>
                                        <option>Icterice</option>
                                        <option>Cianotice</option>
                                    </select>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-eye"></i></div>
                                        <div class="exam-label">Mucoase</div>
                                    </div>
                                    <select class="exam-select">
                                        <option value="">Selectează...</option>
                                        <option>Normal colorate, umede</option>
                                        <option>Palide</option>
                                        <option>Uscate</option>
                                        <option>Icterice</option>
                                    </select>
                                </div>
                                <div class="exam-item" id="weightItem">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-weight"></i></div>
                                        <div class="exam-label">Greutate</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="number" class="exam-input" id="weightInput" placeholder="70">
                                        <span class="exam-unit">kg</span>
                                    </div>
                                </div>
                                <div class="exam-item" id="heightItem">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-ruler-vertical"></i></div>
                                        <div class="exam-label">Înălțime</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="number" class="exam-input" id="heightInput" placeholder="165">
                                        <span class="exam-unit">cm</span>
                                    </div>
                                </div>
                                <div class="exam-item" id="imcItem">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-calculator"></i></div>
                                        <div class="exam-label">IMC</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="text" class="exam-input" id="imcInput" readonly style="background:#f1f5f9;">
                                        <span class="exam-unit">kg/m²</span>
                                    </div>
                                    <div class="imc-result" id="imcResult" style="display: none;">
                                        <span class="imc-badge" id="imcBadge"></span>
                                    </div>
                                    <div class="imc-scale-container" id="imcScaleContainer" style="display: none;">
                                        <div class="imc-scale">
                                            <div class="imc-scale-segment underweight"></div>
                                            <div class="imc-scale-segment normal"></div>
                                            <div class="imc-scale-segment overweight"></div>
                                            <div class="imc-scale-segment obese"></div>
                                        </div>
                                        <div class="imc-scale-marker" id="imcMarker"></div>
                                        <div class="imc-scale-labels">
                                            <span>16</span>
                                            <span>18.5</span>
                                            <span>25</span>
                                            <span>30</span>
                                            <span>40</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-tint"></i></div>
                                        <div class="exam-label">Tensiune Arterială</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="text" class="exam-input" placeholder="120/80">
                                        <span class="exam-unit">mmHg</span>
                                    </div>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-heartbeat"></i></div>
                                        <div class="exam-label">Frecv. Cardiacă</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="number" class="exam-input" placeholder="72">
                                        <span class="exam-unit">bpm</span>
                                    </div>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-lungs"></i></div>
                                        <div class="exam-label">Frecv. Respiratorie</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="number" class="exam-input" placeholder="16">
                                        <span class="exam-unit">resp/min</span>
                                    </div>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-thermometer-half"></i></div>
                                        <div class="exam-label">Temperatură</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="text" class="exam-input" placeholder="36.6">
                                        <span class="exam-unit">°C</span>
                                    </div>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-percentage"></i></div>
                                        <div class="exam-label">SpO₂</div>
                                    </div>
                                    <div class="exam-input-row">
                                        <input type="number" class="exam-input" placeholder="98">
                                        <span class="exam-unit">%</span>
                                    </div>
                                </div>
                                <div class="exam-item">
                                    <div class="exam-item-header">
                                        <div class="exam-icon"><i class="fas fa-water"></i></div>
                                        <div class="exam-label">Edeme</div>
                                    </div>
                                    <select class="exam-select">
                                        <option value="">Selectează...</option>
                                        <option>Absente</option>
                                        <option>Gambiere ușoare</option>
                                        <option>Gambiere moderate</option>
                                        <option>Generalizate</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-row" style="margin-top: 16px;">
                                <div class="form-group full-width">
                                    <label class="form-label">Observații examen general</label>
                                    <textarea class="form-textarea" rows="2" placeholder="Alte constatări la examenul clinic general..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-stethoscope"></i> Examen Clinic Local (pe aparate)</h3>
                            <div class="expandable-section open">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-heart"></i> Cardiovascular</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Zgomote cardiace</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Ritmice, bine bătute</option>
                                                <option>Ritmice, asurzite</option>
                                                <option>Aritmice</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Sufluri</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Absente</option>
                                                <option>Sistolic gr I-II</option>
                                                <option>Sistolic gr III-IV</option>
                                                <option>Diastolic</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Puls periferic</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Prezent simetric</option>
                                                <option>Diminuat</option>
                                                <option>Absent</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group full-width">
                                            <label class="form-label">Observații</label>
                                            <textarea class="form-textarea" rows="2" placeholder="Șoc apexian, jugulare, edeme..."></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="expandable-section">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-lungs"></i> Respirator</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Murmur vezicular</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Prezent bilateral</option>
                                                <option>Diminuat</option>
                                                <option>Abolit</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Raluri</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Absente</option>
                                                <option>Ronflante</option>
                                                <option>Sibilante</option>
                                                <option>Crepitante</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Percuție</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Sonoritate normală</option>
                                                <option>Hipersonoritate</option>
                                                <option>Matitate</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="expandable-section">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-stomach"></i> Digestiv</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">Abdomen</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Suplu, mobil</option>
                                                <option>Destins</option>
                                                <option>Meteorism</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Ficat</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Nepalpabil</option>
                                                <option>La rebord</option>
                                                <option>Hepatomegalie</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Splină</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Nepalpabilă</option>
                                                <option>Palpabilă</option>
                                                <option>Splenomegalie</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="expandable-section">
                                <div class="expandable-header">
                                    <h4><i class="fas fa-brain"></i> Neurologic</h4>
                                    <span class="expandable-toggle"><i class="fas fa-chevron-down"></i></span>
                                </div>
                                <div class="expandable-content">
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label class="form-label">ROT</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Prezente simetric</option>
                                                <option>Diminuate</option>
                                                <option>Abolite</option>
                                                <option>Exagerate</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Babinski</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Absent bilateral</option>
                                                <option>Prezent stânga</option>
                                                <option>Prezent dreapta</option>
                                                <option>Prezent bilateral</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label class="form-label">Semne meningiene</label>
                                            <select class="form-select">
                                                <option value="">Selectează...</option>
                                                <option>Absente</option>
                                                <option>Kernig +</option>
                                                <option>Brudzinski +</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-microscope"></i> Investigații Paraclinice</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Analize laborator</label>
                                    <textarea class="form-textarea" placeholder="Rezultate analize..."></textarea>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Investigații imagistice</label>
                                    <textarea class="form-textarea" placeholder="Rx, Eco, CT, RMN..."></textarea>
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label class="form-label">Alte investigații (EKG, EEG, etc.)</label>
                                    <textarea class="form-textarea" rows="2" placeholder="Alte investigații complementare..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 3: Diagnostic & Tratament -->
                    <div class="tab-panel" id="tab-3">
                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-search"></i> Căutare Cod ICD-10</h3>
                            <div class="icd-search-container">
                                <i class="fas fa-search icd-search-icon"></i>
                                <input type="text" class="icd-search-input" placeholder="Căutați după cod sau denumire (ex: I10, Hipertensiune)">
                            </div>

                            <h3 class="section-title" style="margin-top: 20px;"><i class="fas fa-diagnoses"></i> Diagnostice Stabilite</h3>
                            <div class="diagnosis-cards" id="diagnosisContainer">
                                <div class="diagnosis-card">
                                    <div class="diagnosis-card-header">
                                        <span class="diagnosis-type principal">Principal</span>
                                        <div class="diagnosis-info">
                                            <input type="text" class="diagnosis-code-input" value="I10" placeholder="Cod">
                                            <input type="text" class="diagnosis-name-input" value="Hipertensiune arterială esențială" placeholder="Denumire diagnostic">
                                        </div>
                                        <div class="diagnosis-actions">
                                            <button class="btn-icon" onclick="removeDiagnosis(this)"><i class="fas fa-times"></i></button>
                                        </div>
                                    </div>
                                    <div class="diagnosis-card-body">
                                        <div class="diagnosis-details-label">Detalii diagnostic</div>
                                        <textarea class="diagnosis-details-textarea" placeholder="Descrieți detaliat diagnosticul...">HTA esențială stadiul II, risc cardiovascular înalt.</textarea>
                                    </div>
                                </div>
                                <div class="diagnosis-card">
                                    <div class="diagnosis-card-header">
                                        <span class="diagnosis-type secundar">Secundar</span>
                                        <div class="diagnosis-info">
                                            <input type="text" class="diagnosis-code-input" value="E11.9" placeholder="Cod">
                                            <input type="text" class="diagnosis-name-input" value="Diabet zaharat tip 2 fără complicații" placeholder="Denumire diagnostic">
                                        </div>
                                        <div class="diagnosis-actions">
                                            <button class="btn-icon" onclick="removeDiagnosis(this)"><i class="fas fa-times"></i></button>
                                        </div>
                                    </div>
                                    <div class="diagnosis-card-body">
                                        <div class="diagnosis-details-label">Detalii diagnostic</div>
                                        <textarea class="diagnosis-details-textarea" placeholder="Descrieți detaliat diagnosticul...">DZ tip 2 diagnosticat în 2020. HbA1c ultimă valoare 7.2%.</textarea>
                                    </div>
                                </div>
                                <button class="add-btn" id="addDiagnosisBtn"><i class="fas fa-plus"></i> Adaugă diagnostic</button>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-pills"></i> Prescripție Medicamentoasă</h3>
                            
                            <!-- Allergy Alert -->
                            <div class="allergy-alert" id="allergyAlert">
                                <div class="allergy-alert-icon">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div class="allergy-alert-content">
                                    <div class="allergy-alert-title">⚠️ Atenție - Alergie cunoscută!</div>
                                    <div class="allergy-alert-message" id="allergyAlertMessage">Pacientul are alergie la Penicilină. Verificați medicamentele prescrise!</div>
                                </div>
                                <button class="allergy-alert-close" onclick="hideAllergyAlert()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <table class="medication-table">
                                <thead>
                                    <tr>
                                        <th style="width:28%">Medicament</th>
                                        <th style="width:12%">Doză</th>
                                        <th style="width:20%">Frecvență</th>
                                        <th style="width:12%">Durată</th>
                                        <th style="width:12%">Cantitate</th>
                                        <th style="width:8%"></th>
                                    </tr>
                                </thead>
                                <tbody id="medicationTableBody">
                                    <tr>
                                        <td>
                                            <div class="med-name-cell">
                                                <span class="med-icon"><i class="fas fa-capsules"></i></span>
                                                <input type="text" class="form-input" value="Ramipril">
                                            </div>
                                        </td>
                                        <td><input type="text" class="form-input" value="10mg"></td>
                                        <td>
                                            <select class="form-select">
                                                <option selected>1x/zi dimineața</option>
                                                <option>1x/zi seara</option>
                                                <option>2x/zi</option>
                                                <option>3x/zi</option>
                                            </select>
                                        </td>
                                        <td><input type="text" class="form-input" value="3 luni"></td>
                                        <td><input type="text" class="form-input" value="90 cp"></td>
                                        <td><button class="btn-icon" onclick="removeMedication(this)"><i class="fas fa-trash"></i></button></td>
                                    </tr>
                                    <tr>
                                        <td>
                                            <div class="med-name-cell">
                                                <span class="med-icon"><i class="fas fa-tablets"></i></span>
                                                <input type="text" class="form-input" value="Metformin">
                                            </div>
                                        </td>
                                        <td><input type="text" class="form-input" value="850mg"></td>
                                        <td>
                                            <select class="form-select">
                                                <option>1x/zi dimineața</option>
                                                <option>1x/zi seara</option>
                                                <option selected>2x/zi</option>
                                                <option>3x/zi</option>
                                            </select>
                                        </td>
                                        <td><input type="text" class="form-input" value="3 luni"></td>
                                        <td><input type="text" class="form-input" value="180 cp"></td>
                                        <td><button class="btn-icon" onclick="removeMedication(this)"><i class="fas fa-trash"></i></button></td>
                                    </tr>
                                </tbody>
                            </table>
                            <button class="add-btn" id="addMedicationBtn" style="margin-top: 12px;"><i class="fas fa-plus"></i> Adaugă medicament</button>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-notes-medical"></i> Tratament Non-farmacologic</h3>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label class="form-label">Recomandări igieno-dietetice</label>
                                    <textarea class="form-textarea" placeholder="Regim alimentar, activitate fizică, modificări stil de viață..."></textarea>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Tab 4: Concluzii -->
                    <div class="tab-panel" id="tab-4">
                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-clipboard-check"></i> Recomandări</h3>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label class="form-label">Recomandări pentru pacient</label>
                                    <textarea class="form-textarea" style="min-height: 140px;" placeholder="1. Monitorizare TA de 2x/zi&#10;2. Regim hiposodat&#10;3. Activitate fizică regulată"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-calendar-check"></i> Control și Monitorizare</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Data programată control</label>
                                    <input type="date" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Investigații la control</label>
                                    <input type="text" class="form-input" placeholder="ex: Profil lipidic, HbA1c, EKG">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group full-width">
                                    <label class="form-label">Observații finale</label>
                                    <textarea class="form-textarea" rows="3" placeholder="Notițe suplimentare..."></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="section-divider"></div>

                        <div class="form-section">
                            <h3 class="section-title"><i class="fas fa-file-signature"></i> Semnătură și Validare</h3>
                            <div class="form-row">
                                <div class="form-group">
                                    <label class="form-label">Data consultației</label>
                                    <input type="date" class="form-input" id="consultationDate">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Medic curant</label>
                                    <input type="text" class="form-input" value="Dr. Adrian Popescu" readonly style="background:#f1f5f9;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Cod Parafă</label>
                                    <input type="text" class="form-input" value="DR001234" readonly style="background:#f1f5f9;">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="form-footer">
                        <div class="footer-left">
                            <span class="autosave-indicator" id="autosaveIndicator">
                                <i class="fas fa-check-circle"></i>
                                Salvat automat la 14:32
                            </span>
                        </div>
                        <div class="footer-right">
                            <button class="btn btn-outline" id="prevTabBtn"><i class="fas fa-arrow-left"></i> Înapoi</button>
                            <button class="btn btn-outline" id="saveDraftBtn"><i class="fas fa-save"></i> Salvează Draft</button>
                            <button class="btn btn-success" id="nextTabBtn"><i class="fas fa-check"></i> Continuă</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ===== TAB SWITCHING =====
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabPanels = document.querySelectorAll('.tab-panel');
        const progressBar = document.getElementById('tabsProgressBar');
        let currentTab = 0;

        function switchToTab(index) {
            if (index < 0 || index >= tabBtns.length) return;
            tabBtns.forEach(b => b.classList.remove('active'));
            tabPanels.forEach(p => p.classList.remove('active'));
            tabBtns[index].classList.add('active');
            tabPanels[index].classList.add('active');
            currentTab = index;
            updateNavButtons();
            updateProgressBar();
        }

        function updateProgressBar() {
            const progress = ((currentTab + 1) / tabBtns.length) * 100;
            progressBar.style.width = progress + '%';
        }

        function updateNavButtons() {
            const nextBtn = document.getElementById('nextTabBtn');
            if (currentTab === tabBtns.length - 1) {
                nextBtn.innerHTML = '<i class="fas fa-check"></i> Finalizează';
            } else {
                nextBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Continuă';
            }
        }

        tabBtns.forEach((btn, index) => {
            btn.addEventListener('click', () => switchToTab(index));
        });

        document.getElementById('prevTabBtn').addEventListener('click', () => switchToTab(currentTab - 1));
        document.getElementById('nextTabBtn').addEventListener('click', () => {
            if (currentTab < tabBtns.length - 1) {
                switchToTab(currentTab + 1);
            } else {
                showToast('success', 'Finalizat!', 'Consultația a fost salvată.');
            }
        });

        // ===== KEYBOARD SHORTCUTS =====
        document.addEventListener('keydown', (e) => {
            // Ctrl + S = Save
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                showToast('success', 'Salvat', 'Draft salvat cu succes.');
            }
            // Ctrl + Arrow Right = Next Tab
            if (e.ctrlKey && e.key === 'ArrowRight') {
                e.preventDefault();
                if (currentTab < tabBtns.length - 1) {
                    switchToTab(currentTab + 1);
                }
            }
            // Ctrl + Arrow Left = Previous Tab
            if (e.ctrlKey && e.key === 'ArrowLeft') {
                e.preventDefault();
                if (currentTab > 0) {
                    switchToTab(currentTab - 1);
                }
            }
        });

        // Show keyboard hints after 3 seconds
        setTimeout(() => {
            document.getElementById('keyboardHint').classList.add('visible');
        }, 3000);

        function hideKeyboardHint() {
            document.getElementById('keyboardHint').classList.remove('visible');
        }

        // Auto-hide after 10 seconds
        setTimeout(() => {
            hideKeyboardHint();
        }, 13000);

        // ===== CONSULTATION TIMER =====
        let timerSeconds = 0;
        const timerDisplay = document.getElementById('timerDisplay');
        const timerElement = document.getElementById('consultationTimer');

        function updateTimer() {
            timerSeconds++;
            const minutes = Math.floor(timerSeconds / 60);
            const seconds = timerSeconds % 60;
            timerDisplay.textContent = 
                String(minutes).padStart(2, '0') + ':' + 
                String(seconds).padStart(2, '0');
            
            // Warning at 15 minutes
            if (minutes >= 15 && minutes < 20) {
                timerElement.classList.add('warning');
                timerElement.classList.remove('danger');
            }
            // Danger at 20+ minutes
            else if (minutes >= 20) {
                timerElement.classList.remove('warning');
                timerElement.classList.add('danger');
            }
        }

        setInterval(updateTimer, 1000);

        // ===== EXPANDABLE SECTIONS =====
        document.querySelectorAll('.expandable-header').forEach(header => {
            header.addEventListener('click', () => {
                header.parentElement.classList.toggle('open');
            });
        });

        // ===== IMC CALCULATOR WITH VISUAL INDICATOR =====
        const weightInput = document.getElementById('weightInput');
        const heightInput = document.getElementById('heightInput');
        const imcInput = document.getElementById('imcInput');
        const imcResult = document.getElementById('imcResult');
        const imcBadge = document.getElementById('imcBadge');
        const imcScaleContainer = document.getElementById('imcScaleContainer');
        const imcMarker = document.getElementById('imcMarker');

        function calculateIMC() {
            if (!weightInput || !heightInput || !imcInput) {
                console.error('IMC elements not found');
                return;
            }
            
            const weight = parseFloat(weightInput.value);
            const height = parseFloat(heightInput.value) / 100;
            
            console.log('Calculating IMC:', weight, height); // Debug
            
            if (weight > 0 && height > 0) {
                const imc = weight / (height * height);
                const imcRounded = imc.toFixed(1);
                imcInput.value = imcRounded;
                
                // Show result elements
                if (imcResult) imcResult.style.display = 'flex';
                if (imcScaleContainer) imcScaleContainer.style.display = 'block';
                
                // Determine category
                let category, icon, className;
                if (imc < 18.5) {
                    category = 'Subponderal';
                    icon = 'fa-arrow-down';
                    className = 'underweight';
                } else if (imc < 25) {
                    category = 'Normal';
                    icon = 'fa-check';
                    className = 'normal';
                } else if (imc < 30) {
                    category = 'Supraponderal';
                    icon = 'fa-arrow-up';
                    className = 'overweight';
                } else if (imc < 35) {
                    category = 'Obezitate gr. I';
                    icon = 'fa-exclamation';
                    className = 'obese';
                } else if (imc < 40) {
                    category = 'Obezitate gr. II';
                    icon = 'fa-exclamation-triangle';
                    className = 'obese';
                } else {
                    category = 'Obezitate gr. III';
                    icon = 'fa-exclamation-circle';
                    className = 'obese-severe';
                }
                
                // Update badge
                if (imcBadge) {
                    imcBadge.className = 'imc-badge ' + className;
                    imcBadge.innerHTML = `<i class="fas ${icon}"></i> ${category}`;
                }
                
                // Update marker position (scale: 16-40 = 0-100%)
                if (imcMarker) {
                    let markerPosition = ((imc - 16) / (40 - 16)) * 100;
                    markerPosition = Math.max(0, Math.min(100, markerPosition));
                    imcMarker.style.left = markerPosition + '%';
                }
            } else {
                imcInput.value = '';
                if (imcResult) imcResult.style.display = 'none';
                if (imcScaleContainer) imcScaleContainer.style.display = 'none';
            }
        }

        // Attach events for both input and change
        if (weightInput) {
            weightInput.addEventListener('input', calculateIMC);
            weightInput.addEventListener('change', calculateIMC);
        }
        if (heightInput) {
            heightInput.addEventListener('input', calculateIMC);
            heightInput.addEventListener('change', calculateIMC);
        }

        // ===== DIAGNOSIS MANAGEMENT =====
        document.getElementById('addDiagnosisBtn').addEventListener('click', function() {
            const container = document.getElementById('diagnosisContainer');
            const card = document.createElement('div');
            card.className = 'diagnosis-card';
            card.innerHTML = `
                <div class="diagnosis-card-header">
                    <span class="diagnosis-type secundar">Secundar</span>
                    <div class="diagnosis-info">
                        <input type="text" class="diagnosis-code-input" placeholder="Cod">
                        <input type="text" class="diagnosis-name-input" placeholder="Denumire diagnostic">
                    </div>
                    <div class="diagnosis-actions">
                        <button class="btn-icon" onclick="removeDiagnosis(this)"><i class="fas fa-times"></i></button>
                    </div>
                </div>
                <div class="diagnosis-card-body">
                    <div class="diagnosis-details-label">Detalii diagnostic</div>
                    <textarea class="diagnosis-details-textarea" placeholder="Descrieți detaliat diagnosticul..."></textarea>
                </div>
            `;
            container.insertBefore(card, this);
            showToast('success', 'Adăugat', 'Diagnostic nou adăugat.');
        });

        function removeDiagnosis(btn) {
            const card = btn.closest('.diagnosis-card');
            if (card.querySelector('.diagnosis-type.principal')) {
                showToast('warning', 'Atenție', 'Nu puteți șterge diagnosticul principal.');
                return;
            }
            card.remove();
            showToast('success', 'Șters', 'Diagnostic eliminat.');
        }

        // ===== MEDICATION MANAGEMENT =====
        document.getElementById('addMedicationBtn').addEventListener('click', function() {
            const tbody = document.getElementById('medicationTableBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>
                    <div class="med-name-cell">
                        <span class="med-icon"><i class="fas fa-pills"></i></span>
                        <input type="text" class="form-input" placeholder="Medicament">
                    </div>
                </td>
                <td><input type="text" class="form-input" placeholder="Doză"></td>
                <td>
                    <select class="form-select">
                        <option>1x/zi dimineața</option>
                        <option>1x/zi seara</option>
                        <option selected>2x/zi</option>
                        <option>3x/zi</option>
                    </select>
                </td>
                <td><input type="text" class="form-input" placeholder="Durată"></td>
                <td><input type="text" class="form-input" placeholder="Cantitate"></td>
                <td><button class="btn-icon" onclick="removeMedication(this)"><i class="fas fa-trash"></i></button></td>
            `;
            tbody.appendChild(row);
            showToast('success', 'Adăugat', 'Medicament nou adăugat.');
        });

        function removeMedication(btn) {
            btn.closest('tr').remove();
            showToast('success', 'Șters', 'Medicament eliminat.');
        }

        // ===== TOAST NOTIFICATIONS =====
        function showToast(type, title, message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            const icons = { success: 'fa-check', warning: 'fa-exclamation-triangle', error: 'fa-times-circle' };
            toast.innerHTML = `
                <div class="toast-icon"><i class="fas ${icons[type]}"></i></div>
                <div class="toast-content">
                    <div class="toast-title">${title}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()"><i class="fas fa-times"></i></button>
            `;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 3000);
        }

        // ===== AUTOSAVE =====
        document.querySelectorAll('input, textarea, select').forEach(el => {
            el.addEventListener('change', () => {
                const indicator = document.getElementById('autosaveIndicator');
                const time = new Date().toLocaleTimeString('ro-RO', { hour: '2-digit', minute: '2-digit' });
                indicator.innerHTML = `<i class="fas fa-check-circle"></i> Salvat automat la ${time}`;
            });
        });

        // ===== MOBILE MENU =====
        document.getElementById('mobileMenuBtn')?.addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('sidebarOverlay').classList.toggle('active');
        });
        document.getElementById('sidebarOverlay')?.addEventListener('click', () => {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('sidebarOverlay').classList.remove('active');
        });

        // ===== SAVE DRAFT =====
        document.getElementById('saveDraftBtn').addEventListener('click', () => {
            showToast('success', 'Salvat', 'Draft salvat cu succes.');
        });

        // ===== SET TODAY DATE =====
        document.getElementById('consultationDate').valueAsDate = new Date();

        // ===== CHARACTER COUNTER FOR TEXTAREAS =====
        function initCharCounters() {
            document.querySelectorAll('.form-textarea').forEach(textarea => {
                // Skip if already has counter
                if (textarea.parentElement.classList.contains('textarea-wrapper')) return;
                
                // Wrap textarea
                const wrapper = document.createElement('div');
                wrapper.className = 'textarea-wrapper';
                textarea.parentNode.insertBefore(wrapper, textarea);
                wrapper.appendChild(textarea);
                
                // Add counter
                const counter = document.createElement('span');
                counter.className = 'char-counter';
                const maxLength = textarea.getAttribute('maxlength') || 500;
                counter.textContent = `0/${maxLength}`;
                wrapper.appendChild(counter);
                
                textarea.classList.add('has-counter');
                
                // Update counter on input
                textarea.addEventListener('input', function() {
                    const current = this.value.length;
                    const max = parseInt(maxLength);
                    counter.textContent = `${current}/${max}`;
                    
                    // Update counter color
                    counter.classList.remove('warning', 'danger');
                    if (current >= max * 0.9) {
                        counter.classList.add('danger');
                    } else if (current >= max * 0.75) {
                        counter.classList.add('warning');
                    }
                });
            });
        }
        
        // Initialize on load
        initCharCounters();

        // ===== ALLERGY ALERT SYSTEM =====
        const patientAllergies = ['penicilină', 'penicilina', 'amoxicilină', 'amoxicilina', 'ampicilină', 'ampicilina'];
        
        function checkMedicationAllergies() {
            const medicationInputs = document.querySelectorAll('#medicationTableBody .form-input');
            let allergyFound = false;
            
            medicationInputs.forEach(input => {
                const value = input.value.toLowerCase();
                const isAllergy = patientAllergies.some(allergy => value.includes(allergy));
                
                if (isAllergy) {
                    input.classList.add('allergy-match');
                    allergyFound = true;
                } else {
                    input.classList.remove('allergy-match');
                }
            });
            
            if (allergyFound) {
                showAllergyAlert();
            }
        }
        
        function showAllergyAlert() {
            const alert = document.getElementById('allergyAlert');
            alert.classList.add('active');
        }
        
        function hideAllergyAlert() {
            const alert = document.getElementById('allergyAlert');
            alert.classList.remove('active');
        }
        
        // Monitor medication inputs
        document.getElementById('medicationTableBody').addEventListener('input', function(e) {
            if (e.target.classList.contains('form-input')) {
                checkMedicationAllergies();
            }
        });

        // ===== ENHANCED TIMER TOOLTIP =====
        function updateTimerTooltip() {
            const tooltip = document.getElementById('timerTooltip');
            const minutes = Math.floor(timerSeconds / 60);
            
            if (minutes < 10) {
                tooltip.textContent = 'Durată optimă: 15-20 min';
            } else if (minutes < 15) {
                tooltip.textContent = `Încă ${15 - minutes} min până la timpul optim`;
            } else if (minutes < 20) {
                tooltip.textContent = '✓ Durată optimă';
            } else if (minutes < 25) {
                tooltip.textContent = '⚠️ Depășit timpul recomandat';
            } else {
                tooltip.textContent = '🔴 Consultație extinsă';
            }
        }
        
        // Update original timer function
        const originalUpdateTimer = updateTimer;
        updateTimer = function() {
            originalUpdateTimer();
            updateTimerTooltip();
        };

        // ===== SCROLL TO TOP BUTTON =====
        const scrollTopBtn = document.getElementById('scrollTopBtn');
        const mainContent = document.querySelector('.main-content');
        
        if (mainContent) {
            mainContent.addEventListener('scroll', function() {
                if (this.scrollTop > 300) {
                    scrollTopBtn.classList.add('visible');
                } else {
                    scrollTopBtn.classList.remove('visible');
                }
            });
        }
        
        scrollTopBtn.addEventListener('click', function() {
            if (mainContent) {
                mainContent.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });

        // ===== LOADING OVERLAY =====
        function showLoading(message = 'Se salvează...') {
            const overlay = document.getElementById('loadingOverlay');
            overlay.querySelector('.loading-text').textContent = message;
            overlay.classList.add('active');
        }
        
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // ===== UNSAVED CHANGES WARNING =====
        let hasUnsavedChanges = false;
        
        document.querySelectorAll('input, textarea, select').forEach(el => {
            el.addEventListener('change', () => {
                hasUnsavedChanges = true;
            });
        });
        
        window.addEventListener('beforeunload', function(e) {
            if (hasUnsavedChanges) {
                e.preventDefault();
                e.returnValue = 'Aveți modificări nesalvate. Sigur doriți să părăsiți pagina?';
                return e.returnValue;
            }
        });

        // ===== ENHANCED SAVE DRAFT WITH LOADING =====
        document.getElementById('saveDraftBtn').addEventListener('click', () => {
            showLoading('Se salvează draft-ul...');
            
            // Simulate save
            setTimeout(() => {
                hideLoading();
                hasUnsavedChanges = false;
                showToast('success', 'Salvat', 'Draft salvat cu succes.');
            }, 800);
        });

        // ===== ENHANCED FINALIZE WITH LOADING =====
        const originalNextTabClick = document.getElementById('nextTabBtn').onclick;
        document.getElementById('nextTabBtn').addEventListener('click', function() {
            if (currentTab === tabBtns.length - 1) {
                showLoading('Se finalizează consultația...');
                
                setTimeout(() => {
                    hideLoading();
                    hasUnsavedChanges = false;
                    showToast('success', 'Finalizat!', 'Consultația a fost salvată.');
                }, 1000);
            }
        });

        // ===== SHOW ALLERGY ALERT ON TAB 3 =====
        const originalSwitchToTab = switchToTab;
        switchToTab = function(index) {
            originalSwitchToTab(index);
            
            // Show allergy reminder on Tab 3 (medications)
            if (index === 2) {
                setTimeout(() => {
                    showToast('warning', 'Reminder', 'Pacientul are alergie la Penicilină!');
                }, 500);
            }
        };
    </script>
</body>
</html>
